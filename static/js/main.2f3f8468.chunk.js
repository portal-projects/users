(this["webpackJsonpusers-by-last-seen"]=this["webpackJsonpusers-by-last-seen"]||[]).push([[0],{59:function(e,t,n){e.exports=n(70)},64:function(e,t,n){},65:function(e,t,n){},70:function(e,t,n){"use strict";n.r(t);var a=n(3),i=n.n(a),r=n(32),c=n.n(r),o=(n(64),n(33)),s=n(12),l=n(13),u=n(15),d=n(14),h=n(36),m=n(42),p=n(43),f=n(41),g=n(7),v=n(34),w=n.n(v),y=(n(65),n(10)),E=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={circles:[],width:window.innerWidth/2,height:window.innerWidth/2},e.updateDimensions=function(){e.setState({width:window.innerWidth/2,height:window.innerWidth/2})},e.mouseClick=function(t){console.log("click",e.state.circles[t.target.id].data)},e.mouseEnter=function(t){console.log("hover",e.state.circles[t.target.id].data)},e.mouseLeave=function(e){},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.updateDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateDimensions)}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this;return i.a.createElement("svg",{width:this.state.width,height:this.state.height},this.state.circles.map((function(t,n){return i.a.createElement("g",{key:n,transform:"translate(".concat(t.x,", ").concat(t.y,")")},i.a.createElement("defs",null,i.a.createElement("pattern",{id:t.id,x:"0",y:"0",width:"1",height:"1"},i.a.createElement("image",{href:t.pic,x:"0",y:"0",width:2*t.r,height:2*t.r}))),i.a.createElement("circle",{size:t.size,id:n,r:t.r,fillOpacity:.7,fill:t.fill,onClick:e.mouseClick,onMouseEnter:e.mouseEnter,onMouseLeave:e.mouseLeave}),t.text)})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(!e.data||"undefined"===typeof e.data.length)return null;var n=e.data,a=y.a({children:n}).sum((function(e){return e.size})).sort((function(e,t){return t.value-e.value}));return{circles:Object(y.b)(a).size([t.width,t.height])(a).children.map((function(e){var t="#17becf",n=i.a.createElement("text",{textAnchor:"middle"},i.a.createElement("tspan",{y:"0.3em",fontSize:"10px"},e.data.username[0]));return e.data.pic&&(t="url(#".concat(e.data.id,")"),n=""),{id:e.data.id,x:e.x,y:e.y,r:e.r,fill:t,pic:e.data.pic,text:n,data:e.data}}))}}}]),n}(a.Component),b=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={circles:[],pictures:[],width:window.innerWidth/2,height:window.innerWidth/2},e.updateDimensions=function(){e.setState({width:window.innerWidth/2,height:window.innerWidth/2})},e.mouseClick=function(e){},e.mouseEnter=function(t){var n=e.state.currentTag;t.target.attributes.tag!==n&&(console.log("tag:",t.target.attributes.tag),e.setState({currentTag:t.target.attributes.tag}))},e.mouseLeave=function(e){},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.updateDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateDimensions)}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this;return i.a.createElement("svg",{width:this.state.width,height:this.state.height},this.state.pictures.map((function(e,t){return i.a.createElement("defs",{key:"circle_packing_defs_".concat(t)},i.a.createElement("pattern",{id:e.id,x:"0",y:"0",width:"1",height:"1"},i.a.createElement("image",{href:e.pic,x:"0",y:"0",width:2*e.r,height:2*e.r})))})),this.state.circles.map((function(t,n){return i.a.createElement("g",{key:"circle_packing_".concat(n),transform:"translate(".concat(t.x,", ").concat(t.y,")")},i.a.createElement("circle",{tag:t.tag,size:t.size,id:n,r:t.r,fillOpacity:t.opacity,fill:t.fill,onClick:e.mouseClick,onMouseEnter:e.mouseEnter,onMouseLeave:e.mouseLeave}),t.text)})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(!e.data||"undefined"===typeof e.data.length)return null;var n=e.data,a=y.a({children:n}).sum((function(e){return e.size})).sort((function(e,t){return t.value-e.value})),r=Object(y.b)(a).size([t.width,t.height]),c={};return{circles:r(a).descendants().slice(1).map((function(e){var t="#17becf",n="0.7",a="",r="";return e.data.children?(t="#000000",n="0.1",r=e.data.name):(r=e.parent.data.name,a=i.a.createElement("text",{textAnchor:"middle"},i.a.createElement("tspan",{y:"0.3em",fontSize:"10px"},e.data.username[0]))),e.data.pic&&(t="url(#circle_pack_".concat(e.data.id,")"),c[e.data.id]={pic:e.data.pic,r:e.r,id:"circle_pack_".concat(e.data.id)},a=""),{id:e.data.id,x:e.x,y:e.y,r:e.r,opacity:n,fill:t,pic:e.data.pic,text:a,data:e.data,tag:r}})),pictures:Object.values(c)}}}]),n}(a.Component),k=n(35),x=n.n(k);function j(){var e=Object(o.a)(["\n    {\n        Tag {\n            name\n            children: people {\n                id\n                username\n                avatar\n            }\n        }\n    }\n"]);return j=function(){return e},e}var O=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={users:{},tags:{}},e.setUserSizeByLastSeen=function(e,t){var n=new Date(1e3*t.bumped),a=Math.abs(e-n),i=Math.ceil(a/36e5);return t.size=i>120?4:120-i,t},e.parseResult=function(t){var n={},a=[],i=new Date;t.data.Tag.forEach((function(t){t.children.length<6||(t.children.forEach((function(t){t.pic="null"===t.avatar?null:"https://cdn.discordapp.com/avatars/".concat(t.id,"/").concat(t.avatar,".png"),t=e.setUserSizeByLastSeen(i,t),n[t.id]=t})),t.children.length>1&&a.push(t))})),e.setState({users:Object.values(n),tags:a})},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;if(2!==window.location.href.split("https://portal-projects.github.io/users/").length){var t=new h.a({link:g.a.from([Object(f.a)((function(e){var t=e.graphQLErrors,n=e.networkError;t&&t.forEach((function(e){var t=e.message,n=e.locations,a=e.path;return console.log("[GraphQL error]: Message: ".concat(t,", Location: ").concat(n,", Path: ").concat(a))})),n&&console.log("net error",n)})),new p.a({uri:"http://localhost:3000/graphql"})]),cache:new m.a}),n=w()(j());t.query({query:n,fetchPolicy:"no-cache"}).then((function(t){e.parseResult(t)}))}else x.a.get("tags.json").then((function(t){console.log("static data",t),e.parseResult(t)}))}},{key:"render",value:function(){return i.a.createElement("div",{className:"UsersByLastSeen"},i.a.createElement("div",{style:{display:"flex"}},i.a.createElement(E,{data:this.state.users}),i.a.createElement(b,{data:this.state.tags})))}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(O,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[59,1,2]]]);
//# sourceMappingURL=main.2f3f8468.chunk.js.map